<!doctype html>
<html lang="{{ page.lang }}" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% include head.html %}
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#3b82f6",
            },
            fontFamily: {
              sans: ["Inter", "sans-serif"], // よりモダンなフォント指定があれば
            },
          },
        },
      };
    </script>
    <style>
      /* スクロールバー非表示 */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* フィルターボタンのアクティブスタイル */
      .filter-btn.active {
        background-color: #374151; /* dark-gray-700 */
        color: white;
      }
      .dark .filter-btn.active {
        background-color: #e5e7eb; /* gray-200 */
        color: black;
      }
    </style>
  </head>
  <body
    class="bg-white text-gray-900 antialiased transition-colors duration-300 dark:bg-black dark:text-white"
  >
    {% include header_new.html show_filter=true %}

    <!-- メインコンテンツ: シンプルなリスト表示 -->
    <main class="container mx-auto min-h-screen max-w-2xl px-5 pb-24">
      <div class="flex flex-col gap-12" id="gallery-grid">
        {% assign posts = site.posts | where:"lang", page.lang %} {% for post in
        posts %}
        <a
          href="{{ post.url }}"
          class="gallery-item group block cursor-pointer"
          data-genre="{{ post.genre }}"
          data-date="{{ post.date | date_to_xmlschema }}"
        >
          <!-- 日付とジャンルタグ -->
          <div
            class="mb-2 flex items-center text-base text-gray-400 dark:text-gray-500"
          >
            <time>{{ post.date | date: "%d %b %Y" }}</time>
            <span class="mx-2 font-medium text-blue-400 dark:text-blue-500"
              >#{{ post.genre }}</span
            >
          </div>

          <!-- タイトル -->
          <h2
            class="mb-3 text-2xl font-bold leading-snug text-gray-900 transition-colors group-hover:text-blue-600 dark:text-gray-50 dark:group-hover:text-blue-400"
          >
            {{ post.title }}
          </h2>

          <!-- 抜粋 -->
          <p
            class="line-clamp-3 text-base leading-relaxed text-gray-600 dark:text-gray-400"
          >
            {{ post.excerpt | strip_html }}
          </p>
        </a>
        {% endfor %} {% for work in site.data.works %}
        <a
          href="{{ work.jp.site_link }}"
          class="gallery-item group block cursor-pointer"
          data-genre="work"
          data-date="{{ work.jp.start_at | date: '%Y-%m-%d' }}"
          target="_blank"
        >
          <div
            class="mb-2 flex items-center text-base text-gray-400 dark:text-gray-500"
          >
            <time
              >{{ work.jp.start_at | date: "%Y" }} - {{ work.jp.end_at | date:
              "%Y" }}</time
            >
            <span class="mx-2 font-medium text-blue-400 dark:text-blue-500"
              >#work</span
            >
          </div>
          <h2
            class="mb-3 text-2xl font-bold leading-snug text-gray-900 transition-colors group-hover:text-blue-600 dark:text-gray-50 dark:group-hover:text-blue-400"
          >
            {{ work.jp.title }}
          </h2>
          <p
            class="line-clamp-3 text-base leading-relaxed text-gray-600 dark:text-gray-400"
          >
            {{ work.jp.short }}
          </p>
        </a>
        {% endfor %}
      </div>
    </main>

    <script>
      // 既存のJSロジック (変更なし)
      document.addEventListener("DOMContentLoaded", function () {
        const filterButtons = document.querySelectorAll(".filter-btn");
        const galleryItems = Array.from(
          document.querySelectorAll(".gallery-item"),
        );
        const galleryGrid = document.getElementById("gallery-grid");
        const themeToggleBtn = document.getElementById("theme-toggle");

        // 日付順ソート
        galleryItems.sort(
          (a, b) => new Date(b.dataset.date) - new Date(a.dataset.date),
        );
        galleryGrid.innerHTML = "";
        galleryItems.forEach((item) => galleryGrid.appendChild(item));

        // フィルター
        filterButtons.forEach((button) => {
          button.addEventListener("click", function () {
            filterButtons.forEach((btn) => btn.classList.remove("active"));
            this.classList.add("active");
            const genre = this.dataset.genre;
            galleryItems.forEach((item) => {
              if (genre === "all" || item.dataset.genre === genre) {
                item.style.display = "block";
              } else {
                item.style.display = "none";
              }
            });
          });
        });

        // ダークモード
        if (
          localStorage.getItem("theme") === "dark" ||
          (!("theme" in localStorage) &&
            window.matchMedia("(prefers-color-scheme: dark)").matches)
        ) {
          document.documentElement.classList.add("dark");
        } else {
          document.documentElement.classList.remove("dark");
        }
        themeToggleBtn.addEventListener("click", function () {
          if (document.documentElement.classList.contains("dark")) {
            document.documentElement.classList.remove("dark");
            localStorage.setItem("theme", "light");
          } else {
            document.documentElement.classList.add("dark");
            localStorage.setItem("theme", "dark");
          }
        });
      });
    </script>
  </body>
</html>
